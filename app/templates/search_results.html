{% extends "base.html" %}

{% load i18n mezzanine_tags organization_tags %}

{% block meta_title %}{% trans "Search Results" %}{% endblock %}
{% block title %}{% trans "Search Results" %}{% endblock %}
{% block extra_head %}
<meta name="robots" content="noindex">
{% endblock %}

{% block breadcrumb_menu %}
<li class="breadcrumb__item">
    <a href="{% url "home" %}">{% trans "Home" %}</a>
</li>
<li class="breadcrumb__item active">{% trans "Search Results" %}</li>
{% endblock %}

{% block main %}

<div class="row">
    <div class="col-lg-8 col-md-push-2">
        <h1 class="dotted">{% trans "Search Results" %}</h1>
    </div>
</div>

<div class="row">
    <div class="col-lg-8 col-lg-push-2">
        <p>
            {% if results.paginator.count == 0 %}
            {% blocktrans %}
            No results were found in {{ search_type }} matching your query: {{ query }}
            {% endblocktrans %}
            {% else %}
            {% blocktrans with start=results.start_index end=results.end_index total=results.paginator.count %}
            Showing {{ start }} to {{ end }} of {{ total }} results in {{ search_type }} matching your query: {{ query }}
            {% endblocktrans %}
            {% endif %}
        </p>

        <p>
            <h4>Filter:</h4>
            {% for key,value in filter_dict.items %}
                <a href="{{ value.url }}" title="{{ key }}">{{ key }} {{ value.count }}</a><br>
            {% endfor %}
            {% if cancel_filter_url %}
                <a href="{{ cancel_filter_url }}" title="">Cancel filter</a>
            {% endif %}
        </p>
        {% for result in results.object_list %}
        {% with result.get_absolute_url as result_url %}

            <h5>
                {{ forloop.counter0|add:results.start_index }})
                 - {{ result|classname }} -
                {% if result_url %}
                    <a href="{{ result_url }}">{{ result }}</a>
                {% else %}
                    {{ result }}
                {% endif %}
            </h5>
            {% if result.description != result|stringformat:"s" %}
                <p>{{ result.description|truncatewords_html:20|safe }}</p>
            {% endif %}
            {% if result_url %}
                <a href="{{ result_url }}">{% trans "read more" %}</a>
            {% endif %}
        {% endwith %}
        {% endfor %}

        {% pagination_for results %}
    </div>
</div>

{% endblock %}
